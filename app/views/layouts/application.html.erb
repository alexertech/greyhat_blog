<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="<%= meta_description %>">
	<link rel="icon" href="favicon.ico" type="image/x-icon" />
	
	<!-- SEO Meta Tags -->
	<meta name="robots" content="index, follow">
	<meta name="language" content="Spanish">
	<meta name="author" content="Greyhat">
	<link rel="canonical" href="<%= canonical_url %>">

	<%= csrf_meta_tags %>
	<%= csp_meta_tag %>
	<% if content_for?(:head) %>
		<%= yield(:head) %>
	<% else %>
		<title><%= page_title %></title>
		
		<!-- Default Open Graph -->
		<meta property="og:type" content="website">
		<meta property="og:title" content="Greyhat - Explorando el Equilibrio entre la TecnologÃ­a y la Vida">
		<meta property="og:description" content="<%= meta_description %>">
		<meta property="og:url" content="<%= canonical_url %>">
		<meta property="og:site_name" content="Greyhat">
		<meta property="og:image" content="<%= asset_url('logo.png') %>">
		<meta property="og:locale" content="es_ES">
		
		<!-- Default Twitter Card -->
		<meta name="twitter:card" content="summary">
		<meta name="twitter:site" content="@greyhatcl">
		<meta name="twitter:title" content="Greyhat">
		<meta name="twitter:description" content="<%= meta_description %>">
		<meta name="twitter:image" content="<%= asset_url('logo.png') %>">
		
		<!-- Structured Data -->
		<%= structured_data_for_website %>
		<%= structured_data_for_organization %>
	<% end %>
	<!-- DNS Prefetch for performance -->
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
	
	<!-- Preconnect to Google Fonts to improve loading performance -->
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600&family=Rubik:wght@400;500&display=swap" rel="stylesheet">
	
	<!-- Font Awesome with performance optimization -->
	<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
	<noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"></noscript>
	
	<!-- Preload critical resources -->
	<%= preload_link_tag asset_path('logo.png'), as: :image %>
    <%= stylesheet_link_tag "tailwind", "inter-font", "data-turbo-track": "reload" %>
	
	<%= stylesheet_link_tag 'application', media: 'all', 'data-turbo-track': 'reload' %>
	<%= javascript_importmap_tags %>
</head>

<body class="bg-gray-50 min-h-screen">

<div id="main_body" class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
	<!-- Header -->
	<header id="header" class="flex flex-col lg:flex-row lg:justify-between lg:items-center mb-6 gap-4">
		<!-- Logo -->
		<div class="logo flex justify-center lg:justify-start flex-grow lg:flex-grow-0 order-1 lg:order-none">
			<%= image_tag "logo.png", class: "h-12 w-auto" %>
		</div>
		
		<!-- Header Search and Dark Mode (Desktop) -->
		<div class="hidden md:flex items-center gap-3 order-2">
			<%= form_with url: search_path, method: :get, local: true, class: "relative" do |form| %>
				<div class="relative">
					<%= form.text_field :q, 
						placeholder: "Buscar...", 
						class: "w-64 px-4 py-2 pr-10 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",
						value: params[:q] %>
					<button class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-primary-600 transition-colors duration-200" 
							type="submit">
						<i class="fas fa-search"></i>
					</button>
				</div>
			<% end %>
			
			<!-- Dark Mode Toggle -->
			<div data-controller="dark-mode">
				<button data-dark-mode-target="toggle"
						data-action="click->dark-mode#toggle"
						class="relative inline-flex items-center justify-center w-12 h-6 bg-gray-200 rounded-full transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary-500 hover:bg-gray-300"
						aria-label="Toggle dark mode">
					<div class="absolute left-1 w-4 h-4 bg-white rounded-full shadow-sm transition-transform duration-200 flex items-center justify-center">
						<i data-dark-mode-target="icon" class="fas fa-sun text-xs text-yellow-600"></i>
					</div>
				</button>
			</div>
		</div>
	</header>
	
	<!-- Navigation -->
	<div class="border-b border-gray-200 mb-6">
		<%= render 'partials/navigation' %>
	</div>
	<!-- Main Content Container -->
	<main class="min-h-screen">
		<!-- Flash Messages -->
		<% if notice %>
			<div class="mb-6 mx-4 bg-green-50 border border-green-200 text-green-800 px-4 py-3 rounded-lg flex items-center" role="alert">
				<i class="fas fa-check-circle mr-2"></i>
				<span><%= notice %></span>
				<button type="button" class="ml-auto text-green-600 hover:text-green-800" onclick="this.parentElement.remove()">
					<i class="fas fa-times"></i>
				</button>
			</div>
		<% end %>

		<% if alert %>
			<div class="mb-6 mx-4 bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg flex items-center" role="alert">
				<i class="fas fa-exclamation-triangle mr-2"></i>
				<span><%= alert %></span>
				<button type="button" class="ml-auto text-red-600 hover:text-red-800" onclick="this.parentElement.remove()">
					<i class="fas fa-times"></i>
				</button>
			</div>
		<% end %>

		<% flash.each do |type, message| %>
			<% next if ['notice', 'alert'].include?(type) %>
			<% 
				alert_classes = case type
				when 'success' then 'bg-green-50 border-green-200 text-green-800'
				when 'error' then 'bg-red-50 border-red-200 text-red-800'
				when 'warning' then 'bg-yellow-50 border-yellow-200 text-yellow-800'
				when 'info' then 'bg-blue-50 border-blue-200 text-blue-800'
				else 'bg-gray-50 border-gray-200 text-gray-800'
				end 
			%>
			<div class="mb-6 mx-4 <%= alert_classes %> border px-4 py-3 rounded-lg flex items-center" role="alert">
				<span><%= message %></span>
				<button type="button" class="ml-auto hover:opacity-75" onclick="this.parentElement.remove()">
					<i class="fas fa-times"></i>
				</button>
			</div>
		<% end %>

		<!-- Page Content -->
		<div class="content-wrapper">
			<%= yield %>
		</div>
	</main>

	<!-- Footer -->
	<footer id="footer" class="mt-12 border-t border-gray-200 bg-white">
		<div class="flex justify-center items-center py-6 text-gray-600 text-sm">
			Greyhat &nbsp;&nbsp;<i class="fa-solid fa-copyright"></i>&nbsp;&nbsp;All rights reserved
		</div>
	</footer>

</div>

</body>

</html>
