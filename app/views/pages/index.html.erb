<div>
  <article>
    <div class="mb-4">
      <%= image_tag "hero_new_welcome.jpg", class: "img-fluid rounded w-100", loading: "lazy" %>
    </div>

    <h2 class="mb-4">Últimos artículos</h2>

    <div class="row">
      <% Post.published.includes(:image_attachment).order("created_at DESC").limit(6).each do |post| %>
        <div class="col-md-12 mb-4">
          <div class="card shadow-sm">
            <div class="row g-0">
              <div class="col-md-3 d-flex align-items-center">
                <% if post.image.attached? %>
                  <div class="p-2" style="height: 170px; width: 100%;">
                    <%= image_tag post.image.variant(:thumb), class: "rounded-start", style: "object-fit: cover; height: 100%; width: 100%;", loading: "lazy" %>
                  </div>
                <% end %>
              </div>
              <div class="col-md-9">
                <div class="card-body">
                  <h5 class="card-title"> <%= link_to post.title, post, class: "text-decoration-none" %>
                  </h5>
                  <p class="card-text small text-muted">
                    <%= post.created_at.strftime("%d %b. %Y") %>
                      <span class="text-muted">• <%= post.total_visits %> lecturas</span>
                  </p>
                  <% if post.body.present? %>
                    <p class="card-text"> <%= post.body.to_plain_text.truncate(150) %>
                    </p>
                    <% if post.tags.any? %>
                      <div class="mb-2">
                        <% post.tags.limit(3).each do |tag| %>
                          <%= link_to tag.name, search_path(tag: tag.name), class: "badge bg-light text-dark text-decoration-none me-1" %>
                        <% end %>
                      </div>
                    <% end %>
                    <%= link_to 'Leer artículo →', post, class: "btn btn-sm btn-outline-primary" %>
                  <% end %>
                </div>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </div>
    <div class="text-center mt-3">
      <a href="/articulos" class="btn btn-primary">Ver todos los artículos</a>
    </div>
    
  </article>
</div>